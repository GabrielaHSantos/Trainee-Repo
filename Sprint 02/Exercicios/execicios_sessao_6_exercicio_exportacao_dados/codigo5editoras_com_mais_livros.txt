SELECT 
	editora.codeditora,
    editora.nome, 
    COUNT(livro.cod) AS quantidade
FROM livro
JOIN editora ON livro.editora = editora.codeditora
JOIN endereco ON editora.endereco = endereco.codendereco
GROUP BY editora.nome, endereco.estado, endereco.cidade
ORDER BY quantidade DESC
LIMIT 5;